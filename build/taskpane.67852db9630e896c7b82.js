"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{15797:function(e,t,r){var n=r(64583).Promise,a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=n))((function(n,o){function l(e){try{i(a.next(e))}catch(e){o(e)}}function c(e){try{i(a.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,c)}i((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function c(c){return function(i){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&c[0]?n.return:c[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,c[1])).done)return a;switch(n=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}};function l(e){for(var t=0,r=0;r<e.length;r++)t*=26,t+=e[r].charCodeAt(0)-"A".charCodeAt(0)+1;return t}function c(e){for(var t,r=e,n="";r>0;)t=(r-1)%26,n=String.fromCharCode(65+t)+n,r=Math.floor((r-1)/26);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.getColumnNumber=l,t.getColumnLetter=c,t.getCellAddress=function(e,t,r,n){var a=c(l(e)+n),o=t+r;return"".concat(a).concat(o)},t.insertText=function(e){return a(this,void 0,void 0,(function(){var t,r=this;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Excel.run((function(t){return a(r,void 0,void 0,(function(){var r,n;return o(this,(function(a){switch(a.label){case 0:return r=t.workbook.worksheets.getActiveWorksheet(),(n=r.getRange("A1")).values=[[e]],n.format.autofitColumns(),[4,t.sync()];case 1:return a.sent(),[2]}}))}))}))];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),console.log("Error: "+t),[3,3];case 3:return[2]}}))}))}},21816:function(e,t,r){var n,a=r(64583).Promise,o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},o.apply(this,arguments)},l=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),c=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),a=0;a<r.length;a++)"default"!==r[a]&&l(t,e,r[a]);return c(t,e),t}),s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=a))((function(a,o){function l(e){try{i(n.next(e))}catch(e){o(e)}}function c(e){try{i(n.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,c)}i((n=n.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var r,n,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=c(0),l.throw=c(1),l.return=c(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function c(c){return function(i){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,c[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&c[0]?n.return:c[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,c[1])).done)return a;switch(n=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,n=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(6===c[0]&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],n=0}finally{r=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}};Object.defineProperty(t,"__esModule",{value:!0});var f=i(r(96540)),m=r(83367),d=r(15797),p=r(96540),b="#4B0DFF",h="#FF6B00",g=(0,m.makeStyles)({root:{backgroundColor:"#000000",color:"#ffffff",minHeight:"100vh",display:"flex",flexDirection:"column",padding:"16px"},header:{marginBottom:"16px",color:b,borderBottom:"2px solid ".concat(b),paddingBottom:"8px"},tabContainer:{marginBottom:"16px"},brandTab:{color:"#ffffff","&:hover":{color:h},"&[data-selected]":{color:h,borderBottomColor:h}},tabLabel:{color:h,fontWeight:"600"},form:{display:"flex",flexDirection:"column",gap:"16px",width:"100%"},card:{padding:"16px",marginBottom:"16px",borderTop:"3px solid ".concat(b),backgroundColor:"#121212",color:"#ffffff"},inputContainer:{display:"flex",flexDirection:"row",gap:"12px",width:"100%"},inputWrapper:{display:"flex",flexDirection:"column",width:"100%",gap:"4px"},label:{color:"#ffffff"},input:o(o({backgroundColor:"#333333",color:"#ffffff"},m.shorthands.border("1px","solid","#555555")),{":focus-within":o({},m.shorthands.border("1px","solid",b))}),formContent:{display:"flex",flexDirection:"column",gap:"16px",width:"100%"},buttonContainer:{marginTop:"16px"},primaryButton:{backgroundColor:b,color:"white","&:hover":{backgroundColor:"".concat(b,"dd")},"&:active":{backgroundColor:"".concat(b,"bb")}},errorMessage:{color:"#ff6b6b",fontSize:m.tokens.fontSizeBase200,marginTop:"8px"},progressContainer:{marginTop:"16px"},progressText:{fontSize:m.tokens.fontSizeBase200,marginBottom:"8px",color:"#ffffff"},brandTitle:{fontSize:"28px",fontWeight:"bold",color:b}});t.default=function(){var e=g(),t=(0,p.useState)("read"),r=t[0],n=t[1],a=(0,m.useId)("input"),o=(0,m.useId)("input"),l=(0,m.useId)("input"),c=(0,p.useState)(0),i=c[0],b=c[1],h=(0,p.useState)(0),v=h[0],y=h[1],w=(0,p.useState)(0),x=w[0],E=w[1],C=(0,p.useState)(!1),k=C[0],_=C[1],N=(0,p.useState)(),O=N[0],S=N[1],T=x>0?(i/x*100).toFixed(2):0,j=(0,m.useId)("textarea"),P=(0,p.useState)(!1),I=P[0],B=P[1],D=(0,p.useState)(),F=D[0],R=D[1],L=function(e){return s(void 0,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,Excel.run((function(t){return s(void 0,void 0,void 0,(function(){var r,n,a,o,l,c,i,s,f,m,d;return u(this,(function(u){switch(u.label){case 0:u.trys.push([0,6,,7]),r=t.workbook,n=r.worksheets,a=0,o=e.worksheets,u.label=1;case 1:return a<o.length?(l=o[a],c=n.getItemOrNullObject(l.name),[4,t.sync()]):[3,4];case 2:for(i in u.sent(),c.isNullObject&&(c=n.add(l.name)),l.cells)s=l.cells[i],f=c.getRange(i),void 0!==s.value&&(f.values=[[s.value]]),void 0!==s.formula&&(f.formulas=[[s.formula]]),void 0!==s.formulaR1C1&&(f.formulasR1C1=[[s.formulaR1C1]]),s.format&&((m=s.format).font&&(f.format.font.name=m.font.name,f.format.font.size=m.font.size,f.format.font.bold=m.font.bold,f.format.font.italic=m.font.italic,f.format.font.underline=m.font.underline,f.format.font.strikethrough=m.font.strikethrough,f.format.font.color=m.font.color),m.backgroundColor&&(f.format.fill.color=m.backgroundColor),m.numberFormat&&(f.numberFormat=[[m.numberFormat]]));u.label=3;case 3:return a++,[3,1];case 4:return[4,t.sync()];case 5:return u.sent(),[3,7];case 6:throw d=u.sent(),R(d.message),d;case 7:return[2]}}))}))}))];case 1:return t.sent(),[2]}}))}))};return f.createElement("div",{className:e.root},f.createElement("div",{className:e.header},f.createElement(m.Title3,{className:e.brandTitle},"ProJets")),f.createElement("div",{className:e.tabContainer},f.createElement(m.TabList,{selectedValue:r,onTabSelect:function(e,t){return n(t.value)}},f.createElement(m.Tab,{className:e.brandTab,value:"read"},f.createElement("span",{className:e.tabLabel},"Read Data")),f.createElement(m.Tab,{className:e.brandTab,value:"write"},f.createElement("span",{className:e.tabLabel},"Write Data")))),"read"===r&&f.createElement(m.Card,{className:e.card},f.createElement("form",{className:e.form,onSubmit:function(e){return s(void 0,void 0,void 0,(function(){var t,r,n,a,o,l;return u(this,(function(c){switch(c.label){case 0:_(!0),S(""),e.preventDefault(),t=new FormData(e.currentTarget),r=t.get("param_1"),n=t.get("param_2"),a=t.get("targetUrl"),c.label=1;case 1:return c.trys.push([1,4,5,6]),[4,s(void 0,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:y(0),E(0),b(0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Excel.run((function(e){return s(void 0,void 0,void 0,(function(){var t,r,n,a,o,l,c,i,s,f,m,p,h,g,v,w,x,C,k;return u(this,(function(u){switch(u.label){case 0:return(t=e.workbook.worksheets).load("items"),[4,e.sync()];case 1:u.sent(),r=[],n=0,a=t.items,u.label=2;case 2:return n<a.length?(o=a[n],b(0),y((function(e){return e+1})),(l=o.getUsedRange()).load(),c=l.getLastRow(),i=l.getLastColumn(),c.load("rowIndex"),i.load("columnIndex"),[4,e.sync()]):[3,12];case 3:return u.sent(),(s=o.getRangeByIndexes(0,0,c.rowIndex+1,i.columnIndex)).load(["values","formulas","formulasR1C1","address","numberFormat","format/font","rowCount","columnCount"]),[4,e.sync()];case 4:u.sent(),f=s.address.split(":")[0].split("!")[1],m=f.replace(/[0-9]/g,""),p=parseInt(f.replace(/[^0-9]/g,"")),h={name:o.name,cells:{}},E(s.rowCount),g=0,u.label=5;case 5:if(!(g<s.rowCount))return[3,10];b((function(e){return e+1})),v=0,u.label=6;case 6:return v<s.columnCount?(w=(0,d.getCellAddress)(m,p,g,v),x=s.getCell(g,v).format.font,C=s.getCell(g,v).format.fill,x.load(["bold","color","italic","name","size","underline","backgroundColor"]),C.load(["color"]),[4,e.sync()]):[3,9];case 7:u.sent(),k={formulaR1C1:s.formulasR1C1[g][v],address:w,rowIndex:g,columnIndex:v,format:{font:{name:x.name,size:x.size,bold:x.bold,italic:x.italic,underline:x.underline,color:x.color},numberFormat:s.numberFormat[g][v],backgroundColor:C.color}},h.cells[w]=k,u.label=8;case 8:return v++,[3,6];case 9:return g++,[3,5];case 10:r.push(h),u.label=11;case 11:return n++,[3,2];case 12:return console.log(r),[2,r]}}))}))}))];case 2:return[2,t.sent()];case 3:throw e=t.sent(),S(e.message),e;case 4:return[2]}}))}))];case 2:return o=c.sent(),[4,fetch(a,{method:"POST",body:JSON.stringify({worksheets:o,params:{param1:r,param2:n}})})];case 3:return c.sent(),[3,6];case 4:return l=c.sent(),S(l.message||"An error occurred during the read operation"),[3,6];case 5:return _(!1),[7];case 6:return[2]}}))}))}},f.createElement("div",{className:e.formContent},f.createElement("div",{className:e.inputWrapper},f.createElement(m.Label,{className:e.label,htmlFor:l},"Target URL"),f.createElement(m.Input,{required:!0,id:l,name:"targetUrl",placeholder:"https://your-api-endpoint.com/data",className:e.input})),f.createElement("div",{className:e.inputContainer},f.createElement("div",{className:e.inputWrapper},f.createElement(m.Label,{className:e.label,htmlFor:a},"Parameter 1"),f.createElement(m.Input,{required:!0,id:a,name:"param_1",placeholder:"Enter first parameter",className:e.input})),f.createElement("div",{className:e.inputWrapper},f.createElement(m.Label,{className:e.label,htmlFor:o},"Parameter 2"),f.createElement(m.Input,{required:!0,id:o,name:"param_2",placeholder:"Enter second parameter",className:e.input}))),f.createElement("div",{className:e.buttonContainer},f.createElement(m.Button,{type:"submit",appearance:"primary",disabled:k,className:e.primaryButton},k?"Processing...":"Read Workbook Data")),k&&f.createElement("div",{className:e.progressContainer},f.createElement(m.Text,{className:e.progressText},"Processing Sheet ",v,": ",i," of ",x," rows (",T,"%)"),f.createElement(m.ProgressBar,{value:Number(T)/100})),O&&f.createElement(m.Text,{className:e.errorMessage},O)))),"write"===r&&f.createElement(m.Card,{className:e.card},f.createElement("form",{className:e.form,onSubmit:function(e){return s(void 0,void 0,void 0,(function(){var t,r,n,a;return u(this,(function(o){switch(o.label){case 0:B(!0),R(""),e.preventDefault(),o.label=1;case 1:return o.trys.push([1,3,4,5]),t=new FormData(e.currentTarget),r=t.get("textArea"),n=JSON.parse(r),[4,L(n)];case 2:return o.sent(),[3,5];case 3:return a=o.sent(),R(a.message||"An error occurred during the write operation"),[3,5];case 4:return B(!1),[7];case 5:return[2]}}))}))}},f.createElement("div",{className:e.formContent},f.createElement("div",{className:e.inputWrapper},f.createElement(m.Label,{className:e.label,htmlFor:j},"JSON Data"),f.createElement(m.Textarea,{resize:"vertical",required:!0,id:j,name:"textArea",placeholder:"Paste your JSON data here...",style:{minHeight:"200px"},className:e.input})),f.createElement("div",{className:e.buttonContainer},f.createElement(m.Button,{type:"submit",appearance:"primary",disabled:I,className:e.primaryButton},I?f.createElement(f.Fragment,null,f.createElement(m.Spinner,{size:"tiny",style:{marginRight:"8px"}}),"Writing Data..."):"Write to Workbook")),F&&f.createElement(m.Text,{className:e.errorMessage},F)))))}},39046:function(){},47590:function(e,t,r){var n,a=r(64583).Promise,o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),a=0;a<r.length;a++)"default"!==r[a]&&o(t,e,r[a]);return l(t,e),t});Object.defineProperty(t,"__esModule",{value:!0});var i=c(r(96540)),s=r(5338),u=r(83367),f=i.lazy((function(){return a.resolve().then((function(){return c(r(21816))}))})),m=document.getElementById("container"),d=m?(0,s.createRoot)(m):void 0;Office.onReady((function(){null==d||d.render(i.createElement(u.FluentProvider,{theme:u.webLightTheme},i.createElement(i.Suspense,{fallback:i.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}},"Loading...")},i.createElement(f,null))))}))}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[96],(function(){return t(47590),t(39046)})),e.O()}]);